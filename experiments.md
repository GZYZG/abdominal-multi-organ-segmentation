# 实验记录

[TOC]

## 在Synapse数据集上的实验
该数据集中一共有13中器官的标签，加上背景，标签值为0-13。每一个训练样本 
$$
(x, y)
$$
由一对`.nii.gz`文件组成。`x`是扫描的切片数据，`y`是对应的标签。

### 对13种器官进行同时分割的实验
#### 1st try
- 数据预处理 ：无
- 模型 ：ResUnet_dice
- 损失函数 ：dice loss
- 其余配置 ：每个3D block中有32个切片，切片width=height=512
- 效果 ：训练时损失函数一直在下降，可以降到0.8左右，但是振荡现象比较明显。测试时，部分器官的分割效果较好，但是大部分分割效果都比较差，主要集中在这几方面：
    - 错分、误分的情况
    - 分割不完整，单个切片中的分割结果存在较多的空洞、零散
    - 由于模型是以与z轴垂直的切片为一个3D block，所以与z轴垂直的切片的分割情况稍好，上述问题虽然也存在但更轻，其它方向的切片分割效果明显更差

#### 2nd try
- 数据预处理 ：去除无器官的切片 => 归一化至[0, 1]
- 模型 ：ResUnet_dice
- 损失函数 ：dice loss
- 其余配置 ：每个3D block中有32个切片，切片width=height=512
- 效果 ：训练时损失函数一直在下降，可以降到0.7左右，但是振荡现象比较明显。测试时，出现奇怪的现象，分割结果呈现为多个平面，完全不可用

### 对部分器官进行分割的实验
将13种器官进行分组，几种分割效果较好的器官划分为一组，效果不好的器官分为一组。
#### 1st try (2020-05-28)
选择的器官为`[1, 2, 3, 6, 7, 8, 9]`
- 数据预处理 ：重采样spacing到(1.5, 1.5, 2) => 对数据进行截断操作，将CT数据中的像素值限制在[-1000, 1000] => 调整窗位、窗宽为(50, 600) => 归一化至[0, 1]
- 模型 ：ResUnet_dice
- 损失函数 ：1/2 * 带背景的dice loss + 1/2 * ce loss
- Optimizer ：Adam
- Learning rate ：1e-4，达到900 epoch后lr衰减为1e-5
- 其余配置 ：每个3D block中有32个切片，切片width=height=512
- 实验过程 ：
    - 直到epoch 38，模型的损失没有明显的下降，一直在2.7左右振荡    (2020-05-29)
